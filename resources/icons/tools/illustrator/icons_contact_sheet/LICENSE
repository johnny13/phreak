Most of the credit for figuring out the logic in this script goes to John Wundes. I have merely applied his work to a special use case for aligning icons on a grid.

See John's license for details about what you can and cannot do with the code.
JS code (c) copyright: John Wundes ( john@wundes.com ) www.wundes.com
copyright full text here:  http://www.wundes.com/js4ai/copyright.txt